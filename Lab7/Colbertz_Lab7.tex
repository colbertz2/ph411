\documentclass[11pt]{article}
    \usepackage{comment} % enables the use of multi-line comments (\ifx \fi) 
    \usepackage{lipsum} %This package just generates Lorem Ipsum filler text. 
    \usepackage{fullpage} % changes the margin
    % Used for importing figures
    \usepackage{graphicx}
    \usepackage{wrapfig}
    \usepackage{float}
    \usepackage{subcaption}
    
\begin{document}

%Header-Make sure you update this information!!!!
\noindent
\large\textbf{Lab 6} \hfill \textbf{Zach Colbert} \\
\normalsize PH 411 \hfill 28 November 2017\\

\section*{Introduction}
In the second lab on op-amps, we take a look at some new features since the last lab--some of which can be very useful for building new circuits, some of which have drawbacks or impose limits on normal operation of op-amps. We also take a look at the ways that positive feedback changes the behavior of a circuit, in comparison to the negative feedback we used in Lab 6.\\


\section{Slew Rate}
\subsection{Experimental}

Op-amps have a property called the \emph{slew rate}, which defines how fast an amplifier can react to sudden changes in their input signal. This is significant because it essentially places a limit on how fast our input signal can cycle before the output signal looks significantly different than we expect.\\

By building a simple circuit around an op-amp, we're able to see this distortion very clearly. We're also able to measure the slew rate of the op-amp by inputting a square wave (the most abrupt signal changes we could possibly make) and measuring the change of the output signal with respect to time in regions where the input signal changes. This measurement of the slope of our output signal, and the literature value for the slew rate, come in units of $V / \mu s$.\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-a.png}
    \caption{A simple op-amp circuit with negative feedback. The output of this signal demonstrates the distortion caused by the slew rate of the amplifier.}
    \label{circuit:a}
\end{figure}


\subsection{Results}

Using an LM-741 op-amp, and applying a $3\ V$ peak-to-peak square wave at $10\ kHz$, we recorded the output signal shown in figure \ref{fig:A-1}.\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{Plots/figA-1.png}
    \caption{Slew distortion of circuit \ref{circuit:a}, using an LM-741 amplifier.}
    \label{fig:A-1}
\end{figure}

We find that the slew rate on the rising edge is about $0.8\ V / \mu s$, and on the falling side is about $0.6 V / \mu s$. Both values are reasonably close to the literature value \footnote{Found in the datasheet at http://www.ti.com/lit/ds/symlink/lm741.pdf} $0.5\ V / \mu s$.\\

For the same device, we also applied a sine wave input for comparison. At $10\ kHz$ we were unable to see any distortion for any input voltage--however, we began to see distortion at $3\ V_{pp}$ near $50\ kHz$. It seems reasonable that we had to increase input frequency by a factor in order to see distortion effects on a sine wave, considering the rate of change of a sine wave is much lower than that of a square wave.\\ 

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{Plots/figA-2.png}
    \caption{Slew distortion of circuit \ref{circuit:a}, using an LM-741 amplifier.}
    \label{fig:A-2}
\end{figure}

For the rising and falling edges of this output signal, we found the slew rate to be about $0.6\ V / \mu s$, closer to the literature value.\\

Using a TL-071 amplifier in the same circuit, we applied the same square wave input as above and found the slew rate to be $12\ V / \mu s$, compared to the $13\ V / \mu s$ literature value \footnote{Found in the datasheet at http://www.ti.com/lit/ds/symlink/tl072a.pdf}. For this amplifier, we had to increase the input frequency to around $900\ kHz$ before we saw similar distortion on a sine wave--and found the slew rate there to be about $8\ V / \mu s$, which is given as the minimum slew rate in literature.\\

Because the rate of change of a sine wave is smaller than that of a square wave, it made sense for us to have increased the input frequency by a small factor for the first amplifier. Changing the frequency by an order of magnitude for the second amplifier isn't quite as reasonable--there is probably some other factor that is affecting the frequency-dependence of the slew rate, but I haven't been able to identify it.\\


\section{Offset Voltage}
\subsection{Results}

One of the features of op-amps is the \emph{offset voltage}. This DC voltage determines the default offset between the two input voltages, and can be adjusted by applying a DC signal to two of the pins on the amplifier. \\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-b1.png}
    \caption{This non-inverting amplifier circuit has a gain of 1000. With the input grounded, we can measure the DC offset voltage of the op-amp.}
    \label{circuit:b1}
\end{figure}

Circuit \ref{circuit:b1}, with the input grounded, can be used to measure the offset voltage of the amplifier. Because there is zero voltage at the non-inverting input, and some offset voltage between that and the inverting input, the circuit will output the offset voltage multiplied by the circuit gain.\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-b2.png}
    \caption{The addition to the circuit at pins 1 and 5 on the op-amp is very simple, and allows us to adjust the DC offset voltage easily.}
    \label{circuit:b2}
\end{figure}

By adding applying a DC signal to pins 1 and 5 of the op-amp through a potentiometer, we're able to adjust or "trim" the offset voltage. \\


\subsection{Results}

With the input of the circuit grounded, we were able to measure a DC signal around $800\ mV$, which translates to an offset voltage of about $0.8\ mV$ considering the circuit gain of 1000. According to the datasheet for the LM-741 amplifier, the offset voltage is typically $1\ mV$. \\

The $10\ k \Omega$ potentiometer was not too sensitive for trimming this circuit, and we were able to adjust it so that the circuit output was very near zero with the input grounded.\\


\section{Integrator}
\subsection{Experimental}

As we did in earlier labs with passive elements, op-amps can also be used to build circuits that integrate or differentiate their input signals. These circuits have a number of applications already, and the use of an active element gives us extra functionality.\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-c.png}
    \caption{An integrator circuit that employs active and passive elements, including an op-amp.}
    \label{circuit:c}
\end{figure}

In this part of the lab, we observe the resulting signal of different kinds of input, and use those to analyze the circuit's behavior as an integrator.\\


\subsection{Results}

Driving the circuit with a $1\ V$ peak-to-peak square wave at $1\ kHz$ resulted in a triangle wave output, with a much smaller amplitude (suggesting gain $\beta < 1$) and a significant DC offset\footnote{Note: We removed the offset trimming circuitry from the previous circuit while building the circuit for this part of the lab, so the offset voltage of the amplifier could have played some part in the DC offset of this signal.}. The type of output signal matches what we would expect from an integrator--regions of a triangle wave have constant rate of change, represented by the constant values of a square wave.\\

This integrating behavior was consistent for similar sine and triangle inputs as well.\\

Adjusting the DC offset of the input signal (via our function generator) also changed the DC offset of the output signal, with a noticeable ($>1$) gain, opposite the direction of the input offset change (positive offset of the input signal resulted in negative offset of the output signal). \\

With the $10\ M \Omega$ resistor removed from the circuit, we noted a much larger gain in the circuit. Same as before, the DC offsets were inverse of each other; but, this time the DC gain appeared to be about 1. \\

This DC offset is the result of charge building up in the capacitor--it charges to a constant DC voltage, which offsets the AC signal passing through the $10\ M \Omega$ resistor. The DC gain that we noticed is likely a relationship between the impedances of the resistor and capacitor--and, naturally, the output offset moves opposite the input offset because we are driving the inverting input.\\

In the first circuit, the resistor has a much lower impedance than the capactitor, and prevents a large voltage from building up on the capacitor. Without the resistor, the voltage across the capacitor is directly related to the input signal and thus the DC gain appears to be about 1. \\


\section{Differentiator}
\subsection{Experimental}

As in the last part of the lab, in part 4 we use a combination of passive elements with an op-amp to create a differentiator circuit.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-d.png}
    \caption{A differentiator circuit comprised of a combination of passive elements and an op-amp.}
    \label{circuit:d}
\end{figure}

This circuit is very similar to the previous one, but passes the input signal through a resistor and capacitor before getting to the point where it meets negative feedback.\\

The differentiated input signals are known, so for this part we simply apply different input signals and compare to the differentiated signals we expect.\\


\subsection{Results}

Driving the circuit with a $1\ kHz$ input, a triangle wave resulted in a square wave output. This matches our expectations, because a triangle wave has a constant rate of change alternating positive and negative as it cycles. This is represented by the positive and negative constant values taken by a square wave as it cycles.\\

The circuit behaved consistently for other types of input signals also. A square wave input resulted in sharp, localized spikes wherever the wave cycled (the "infinite" rate of change of a square wave at certain points). A sine wave resulted in a phase-shifted sine wave (or cosine wave).\\


\section{Positive Feedback}
\subsection{Experimental}

Up until this point, we've exclusively used negative feedback to change the effect of an op-amp on our input signal. Essentially, we've been reducing the enormous gain of the op-amp to something more reasonable for our needs.\\

For this part of the lab, we examine the effects of positive feedback. Conversely from negative feedback, positive feedback has the potential to increase the gain of our op-amp infinitely.\\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-e1.png}
    \caption{This simple op-amp circuit is called a comparator. Essentially, it has such a high gain that nearly any positive or negative signal will come out at $\mp 15\ V$ for an op-amp powered with DC $\pm 15\ V$.}
    \label{circuit:e1}
\end{figure}

By adding some positive feedback, we effectively make the gain much larger and have the ability to work with much smaller signals. \\

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-e2.png}
    \caption{This comparator circuit can handle much smaller signals than circuit \ref{circuit:e1} because it has a much higher gain.}
\end{figure}

Since this circuit can operate normally with much smaller input signals, we expect it to be a better comparator in general (not just for small signals).\\


\subsection{Results}

We powered the first circuit with $\pm 15\ V$. By driving it with a small square wave at low frequency, with a large positive offset (so the whole wave is positive), the output was $-15\ V$ as expected. The same wave with large negative offset resulted in a $+15\ V$ output signal.\\

By slowly adjusting the offset of the wave as it crosses $0\ V$, we observed some strange effects in the output signal. The signal was a kind of distorted triangle wave at $-15\ V$--wherever the input signal becomes negative, the output signal slopes up toward zero. Then, when the input signal cycles and is positive again, the output signal drops back down to $-15\ V$. We were unable to confirm this, but it seems like this could be related to the slew rate of the op-amp.\\

For the second circuit, we observed a similar effect about $0\ V$. In this case, the slope of the output signal is much greater, and the signal actually swings from $+15\ V$ to $-15\ V$ as we expect a comparator to do for a square wave.


\section{RC Oscillator}
\subsection{Experimental}

In the final part of the lab, we look at a special case in which the op-amp circuit has no input, but we can measure an output signal anyway.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{Diagrams/c-f.png}
    \caption{The circuit has no inputs, but has a measurable output signal.}
    \label{circuit:f}
\end{figure}

Knowing that we'll measure some output signal and that it will oscillate, we can predict the frequency of that oscillation using the "golden rules" of op-amps, Kirchoff analysis of the circuit, and properties of the capacitor in the circuit.

Since we know we will measure some output signal, we'll say that $V_{Out}$ is known. Then, treating the $10\ k \Omega$ resistors as a voltage divider, we can find the voltage at the non-inverting input $V_+$:

\begin{equation}
    V_+ = \frac{R_1}{R_1 + R_2} V_{Out} = \frac{1}{2} V_{Out}
\end{equation}

By op-amp rules, we know that $V_+$ and $V_-$ will be the same. Again, we can use the math that describes a voltage divider--this time, to relate this known voltage and the known output voltage to find the frequency-dependent impedance of the capacitor.

\begin{equation}
    \frac{1}{2} V_{Out} = \frac{z_R}{z_R + z_C} V_{Out}
\end{equation}

\begin{equation}
    \frac{1}{2} = \frac{z_R}{z_R + z_C}
\end{equation}

\begin{equation}
    2 z_R = z_R + z_C
\end{equation}

\begin{equation}
    z_R = z_C = \frac{1}{\omega C}
\end{equation}

\begin{equation}
    \omega = \frac{1}{RC} = \frac{1}{100\ k \Omega * 0.1\ \mu F} = 100\ \frac{rad}{s}
\end{equation}

So, we expect the frequency of oscillation to be around $\frac{50}{\pi} Hz$.


\subsection{Results}




\end{document}
